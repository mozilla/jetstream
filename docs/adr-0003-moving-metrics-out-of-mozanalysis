# Moving metrics out of mozanalysis into jetstream-config

* Status: Accepting feedback
* Date: 2022-07-18

Related issue: https://github.com/mozilla/jetstream/issues/1131

## Context and Problem Statement

* metrics defined in jetstream-config, mozanalysis
* all metric definitions in one place
* avoids conflicting definitions and duplicates
* makes publishing new metrics easier

## Decision Drivers

* Legacy code should not break
* Metric definitions in one place

## Implementation

* `definitions/` folder in jetstream-config
    * file per platform with metric definitions
* these metric definitions can be referenced 

* add definitions folder to CODEOWNERS file
    * requires reviews on changes

* separate config parsing library
    * used by jetstream, mozanalysis, jetstream docs generator (opmon in the future?)

* mozanalysis
    * has config parsing library as dependency
    * default url to config definitions set to jetstream-config
    * url can be changed through environment variable (?)
        * or have global module that does the config loading
        * instantiated once (similar to outcome resolver)
        * option to change url
    * exisiting metrics remain, so that existing notebooks do not break, but will use definition from definitions in jetstream-config
    * parameters that are expected to be `Metric` can also be string (slug of metric) in the future
        * or get metric through config loader which will return `Metric`

* docs for existing definitions

## Future

* opmon can use config parsing library